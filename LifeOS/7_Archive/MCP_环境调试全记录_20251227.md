




# Trae MCP 环境调试实战日志

## 2025-12-27 调试流程总结（按操作阶段）

| 阶段 | 核心事项 | 详细操作与结论 |
| :--- | :--- | :--- |
| **阶段 1：诊断** | **问题定位** | 用户反馈安装的 MCP 插件均无法使用。经检查发现 Trae 缺少项目级配置，且全局 `mcp.json` 路径权限未配置。 |
| **阶段 2：初始化** | **配置搭建** | 在根目录创建 `.trae/mcp.json`，并成功集成飞书 MCP 配置，确立了项目级配置优先的原则。 |
| **阶段 3：授权** | **Filesystem 激活** | 手动将 `Filesystem` 授权路径修改为当前工作区 `D:\个人记录\obsidian-file\wjmber\tasks\需求`。 |
| **阶段 4：排错** | **全局配置冲突** | 针对 Slack 等插件启动报错，定位为全局配置中缺少 Token。建议在全局配置中通过 `"disabled": true` 禁用故障插件。 |
| **阶段 5：验证** | **文件系统测试** | 调用 `Filesystem` 工具成功列出根目录及 `归档` 文件夹文件，确认授权与读取功能完全正常。 |
| **阶段 6：扩展** | **X-Search 集成** | 导入 Twitter 自定义配置，并优化启动命令为通用的 `npx` 模式，解决了 node 路径硬编码问题。 |
| **阶段 7：修复** | **NPM 镜像问题** | 针对 `CERT_HAS_EXPIRED` 报错，引导用户将 NPM 镜像源切换至最新的阿里云镜像，恢复了插件下载能力。 |
| **阶段 8：纠偏** | **内容真实性校验** | 在执行 Twitter 搜索时因环境延迟产生幻觉，随后通过 `WebSearch` 获取 Huberman 真实推文并进行翻译分析。 |

---

## 核心技术沉淀

### 1. 配置管理
- **优先级**：项目级配置 (`.trae/mcp.json`) 会补充或覆盖全局配置。
- **稳定性**：对于未完成配置或报错的插件，必须在 JSON 中显式禁用。

### 2. Filesystem 安全规则
- **显式授权**：AI 默认无权访问任何本地目录。
- **路径规范**：Windows 下必须使用双反斜杠 `\\` 且路径必须真实存在。

### 3. 环境依赖
- **NPM 镜像**：旧淘宝镜像已失效，必须使用 `https://registry.npmmirror.com`。
- **重启机制**：修改 `mcp.json` 后必须重启 Trae IDE 才能加载新配置。

---
**当前状态**：MCP 环境已完全修复，所有工具进入稳定就绪状态。
